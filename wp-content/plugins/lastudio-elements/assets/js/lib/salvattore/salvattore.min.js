var salvattore=function(o,s){"use strict";function u(e,t,r){e.dataset?e.dataset[t]=r:e.setAttribute("data-"+t,r)}var d={},n=[],a=[],l=[];return d.obtainGridSettings=function(e){var t=o.getComputedStyle(e,":before").getPropertyValue("content").slice(1,-1),r=t.match(/^\s*(\d+)(?:\s?\.(.+))?\s*$/),n=1,a=[];return r?(n=r[1],a=(a=r[2])?a.split("."):["column"]):(r=t.match(/^\s*\.(.+)\s+(\d+)\s*$/))&&(a=r[1],n=(n=r[2])&&n.split(".")),{numberOfColumns:n,columnClasses:a}},d.addColumns=function(e,t){for(var r,n=d.obtainGridSettings(e),a=n.numberOfColumns,l=n.columnClasses,i=new Array(+a),o=s.createDocumentFragment(),c=a;0!=c--;)r="[data-columns] > *:nth-child("+a+"n-"+c+")",i.push(t.querySelectorAll(r));i.forEach(function(e){var t=s.createElement("div"),r=s.createDocumentFragment();t.className=l.join(" "),Array.prototype.forEach.call(e,function(e){r.appendChild(e)}),t.appendChild(r),o.appendChild(t)}),e.appendChild(o),u(e,"columns",a)},d.removeColumns=function(e){var t=s.createRange();t.selectNodeContents(e);var r=Array.prototype.filter.call(t.extractContents().childNodes,function(e){return e instanceof o.HTMLElement}),n=r.length,a=r[0].childNodes.length,l=new Array(a*n);Array.prototype.forEach.call(r,function(e,r){Array.prototype.forEach.call(e.children,function(e,t){l[t*n+r]=e})});var i=s.createElement("div");return u(i,"columns",0),l.filter(function(e){return!!e}).forEach(function(e){i.appendChild(e)}),i},d.recreateColumns=function(t){o.requestAnimationFrame(function(){d.addColumns(t,d.removeColumns(t));var e=new CustomEvent("columnsChange");t.dispatchEvent(e)})},d.mediaQueryChange=function(e){e.matches&&Array.prototype.forEach.call(n,d.recreateColumns)},d.getCSSRules=function(e){var t;try{t=e.sheet.cssRules||e.sheet.rules}catch(e){return[]}return t||[]},d.getStylesheets=function(){var r=Array.prototype.slice.call(s.querySelectorAll("style"));return r.forEach(function(e,t){"text/css"!==e.type&&""!==e.type&&r.splice(t,1)}),Array.prototype.concat.call(r,Array.prototype.slice.call(s.querySelectorAll("link[rel='stylesheet']")))},d.mediaRuleHasColumnsSelector=function(e){var t,r;try{t=e.length}catch(e){t=0}for(;t--;)if((r=e[t]).selectorText&&r.selectorText.match(/\[data-columns\](.*)::?before$/))return!0;return!1},d.scanMediaQueries=function(){var t,r=[];o.matchMedia&&(d.getStylesheets().forEach(function(e){Array.prototype.forEach.call(d.getCSSRules(e),function(e){try{e.media&&e.cssRules&&d.mediaRuleHasColumnsSelector(e.cssRules)&&r.push(e)}catch(e){}})}),t=a.filter(function(e){return-1===r.indexOf(e)}),l.filter(function(e){return-1!==t.indexOf(e.rule)}).forEach(function(e){e.mql.removeListener(d.mediaQueryChange)}),l=l.filter(function(e){return-1===t.indexOf(e.rule)}),r.filter(function(e){return-1==a.indexOf(e)}).forEach(function(e){var t=o.matchMedia(e.media.mediaText);t.addListener(d.mediaQueryChange),l.push({rule:e,mql:t})}),a.length=0,a=r)},d.rescanMediaQueries=function(){d.scanMediaQueries(),Array.prototype.forEach.call(n,d.recreateColumns)},d.nextElementColumnIndex=function(e,t){for(var r,n=e.children,a=n.length,l=0,i=0,o=0;o<a;o++)r=n[o].children.length+(t[o].children||t[o].childNodes).length,0===l&&(l=r),r<l&&(i=o,l=r);return i},d.createFragmentsList=function(e){for(var t=new Array(e),r=0;r!==e;)t[r]=s.createDocumentFragment(),r++;return t},d.appendElements=function(r,e){var t=r.children,n=t.length,a=d.createFragmentsList(n);Array.prototype.forEach.call(e,function(e){var t=d.nextElementColumnIndex(r,a);a[t].appendChild(e)}),Array.prototype.forEach.call(t,function(e,t){e.appendChild(a[t])})},d.prependElements=function(e,t){var r=e.children,n=r.length,a=d.createFragmentsList(n),l=n-1;t.forEach(function(e){var t=a[l];t.insertBefore(e,t.firstChild),0===l?l=n-1:l--}),Array.prototype.forEach.call(r,function(e,t){e.insertBefore(a[t],e.firstChild)});for(var i=s.createDocumentFragment(),o=t.length%n;0!=o--;)i.appendChild(e.lastChild);e.insertBefore(i,e.firstChild)},d.registerGrid=function(e){var t,r;"none"!==o.getComputedStyle(e).display&&"true"!==e.getAttribute("data-inited")&&(e.setAttribute("data-inited","true"),(t=s.createRange()).selectNodeContents(e),(r=s.createElement("div")).appendChild(t.extractContents()),u(r,"columns",0),d.addColumns(e,r),n.push(e))},d.init=function(){var e=s.createElement("style");e.innerHTML=".layout-salvattore[data-columns]::before{display:block;visibility:hidden;position:absolute;font-size:1px;}",s.head.appendChild(e);var t=s.querySelectorAll(".layout-salvattore[data-columns]");Array.prototype.forEach.call(t,d.registerGrid),d.scanMediaQueries()},d.init(),{appendElements:d.appendElements,prependElements:d.prependElements,registerGrid:d.registerGrid,recreateColumns:d.recreateColumns,rescanMediaQueries:d.rescanMediaQueries,init:d.init,append_elements:d.appendElements,prepend_elements:d.prependElements,register_grid:d.registerGrid,recreate_columns:d.recreateColumns,rescan_media_queries:d.rescanMediaQueries}}(window,window.document);